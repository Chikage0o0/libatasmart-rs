# libatasmart-rs

ATA S.M.A.R.T. ç¡¬ç›˜å¥åº·ç›‘æ§åº“ (Rust å®ç°)

è¿™æ˜¯ [libatasmart](http://0pointer.de/blog/projects/being-smart.html) C åº“çš„ Rust é‡æ„ç‰ˆæœ¬ã€‚

## ç‰¹æ€§

- âœ… ç±»å‹å®‰å…¨çš„ Rust API
- âœ… æ‰€æœ‰ unsafe ä»£ç éš”ç¦»åœ¨ FFI æ¨¡å—ä¸­
- âœ… ä½¿ç”¨ `nix` crate æä¾›å®‰å…¨çš„ç³»ç»Ÿè°ƒç”¨å°è£…
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- ğŸš§ è¯»å–ç¡¬ç›˜ SMART æ•°æ® (å¼€å‘ä¸­)
- ğŸš§ è§£æç¡¬ç›˜å¥åº·çŠ¶æ€ (å¼€å‘ä¸­)
- ğŸš§ æ‰§è¡Œç¡¬ç›˜è‡ªæ£€ (å¼€å‘ä¸­)

## å¹³å°æ”¯æŒ

ç›®å‰ä»…æ”¯æŒ Linux å¹³å°ã€‚

## ä½¿ç”¨ç¤ºä¾‹

```rust
use atasmart::Disk;

fn main() -> Result<(), Box<dyn std::error::Error>> {
    // æ‰“å¼€ç£ç›˜è®¾å¤‡
    let disk = Disk::open("/dev/sda")?;

    // è·å–è®¾å¤‡ä¿¡æ¯
    println!("è®¾å¤‡å¤§å°: {} å­—èŠ‚", disk.size());
    println!("è®¾å¤‡ç±»å‹: {:?}", disk.disk_type());

    // TODO: æ›´å¤šåŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­

    Ok(())
}
```

## å‘½ä»¤è¡Œå·¥å…·

```bash
# ç¼–è¯‘ç¤ºä¾‹ç¨‹åº
cargo build --example skdump

# è¿è¡Œ (éœ€è¦ root æƒé™)
sudo ./target/debug/examples/skdump /dev/sda
```

## å¼€å‘çŠ¶æ€

æœ¬é¡¹ç›®æ­£åœ¨ç§¯æå¼€å‘ä¸­ã€‚å½“å‰å·²å®Œæˆ:

- [x] é¡¹ç›®ç»“æ„å’Œæ¨¡å—åˆ’åˆ†
- [x] é”™è¯¯å¤„ç†å’Œç±»å‹å®šä¹‰
- [x] FFI å±‚ unsafe ä»£ç å°è£…
- [x] åŸºç¡€è®¾å¤‡æ“ä½œ
- [ ] SMART æ•°æ®è¯»å–å’Œè§£æ (è¿›è¡Œä¸­)
- [ ] IDENTIFY æ•°æ®è¯»å–
- [ ] å±æ€§è§£æå’Œå¥åº·è¯„ä¼°
- [ ] å®Œæ•´çš„æµ‹è¯•è¦†ç›–

## è®¸å¯è¯

LGPL-2.1-or-later

## åŸå§‹é¡¹ç›®

æœ¬é¡¹ç›®åŸºäº Lennart Poettering çš„ libatasmart C åº“é‡æ„è€Œæ¥ã€‚

åŸå§‹ C ä»£ç ä¿å­˜åœ¨ `c-original/` ç›®å½•ä¸­ä¾›å‚è€ƒã€‚
